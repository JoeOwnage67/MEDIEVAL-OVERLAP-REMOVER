<?xml version="1.0" encoding="utf-8" ?>

<Patch>

<!-- VFE MEDIEVAL 2 OVERLAP -->
	<Operation Class="PatchOperationSequence">
                <operations>

                <!-- remove new kingdom start (bugged as all hell every time I try it) -->
                <li Class="PatchOperationRemove">
                    <xpath>Defs/ScenarioDef[defName="VFEM2_NewKingdom"]</xpath>
                </li>

                <!-- apiary/honey/honeycomb/mead -->
                <!-- Ferny and I realized that VFE honey is C#, so we can't change VFE honey to MO honey-->
                    <li Class="PatchOperationAdd">
                        <xpath>/Defs</xpath>
                        <value>
                            <ReplaceLib.ReplacerDef>
                                <defName>JOE_MO_VFEM2_HoneyStuff</defName>
                                <replacers>
                                    <li>
                                        <replace>DankPyon_Honey</replace>
                                        <with>VFEM2_Honey</with>
                                    </li>
                                    <li>
                                        <replace>VFEM2_Mead</replace>
                                        <with>DankPyon_Mead</with>
                                    </li>
                                </replacers>
                            </ReplaceLib.ReplacerDef>
                        </value>
                    </li>

                <!-- reflavour MO apiary -->    
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="DankPyon_Apiary"]/label</xpath>
                        <value>
                            <label>artifical hornet nest</label>
                        </value>
                    </li>

                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="DankPyon_Apiary"]/description</xpath>
                        <value>
                            <description>An artifical hornet nest. An extraordinary structure crafted from wood, clay, iron and woven straw. The hive houses a swarm of specially bred hornets, nurtured to produce a unique, viscous substance known as hornet honey. Unlike ordinary honey, hornet honey is rich in nutrients, granting those who consume it bursts of energy and resilienceâ€”an invaluable resource for knights preparing for battle or peasants enduring harsh winters. The cultivation of hornet honey is a very time consuming process.</description>
                        </value>
                    </li>

                <!-- have hornet nest give hornet queen -->
                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="DankPyon_HornetNest"]/killedLeavings</xpath>
                        <value>
                            <Joe_HornetQueen>1</Joe_HornetQueen>    
                        </value>
                    </li>

                <!-- have apiary require hornet queen -->
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="DankPyon_Apiary"]/costList</xpath>
                        <value>
                            <costList>
                                <DankPyon_IronIngot>5</DankPyon_IronIngot>
                                <Joe_HornetQueen>1</Joe_HornetQueen>
                                <DankPyon_Clay>15</DankPyon_Clay>
                                <DankPyon_Straw>10</DankPyon_Straw>
                            </costList>
                        </value>
                    </li>

                <!-- decrease yield -->
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="DankPyon_Apiary"]/comps/li[@Class="MedievalOverhaul.CompProperties_ThingProducer"]/timeRequired</xpath>
                        <value>
                            <timeRequired>1500000</timeRequired>
                        </value>
                    </li>

                <!-- desired products will be produced -->
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="DankPyon_Apiary"]//comps/li[@Class="MedievalOverhaul.CompProperties_ThingProducer"]/items</xpath>
                        <value>
                            <items>
                                <li>
                                    <thingDef>DankPyon_HornetHoney</thingDef>
                                    <countRange>3~6</countRange>
                                    <weight>1</weight>
                                </li>
                                <li>
                                    <thingDef>Joe_HornetQueen</thingDef>
                                    <countRange>-25~1</countRange>
                                    <weight>1</weight>
                                </li>
                            </items>
                        </value>
                    </li>

                    <!-- hide VFEM2 barrels (I think MO patch already does this) -->
                    <!--<li Class="PatchOperationRemove">
                      <xpath>Defs/ThingDef[defName="VFEM2_MeadFermentingBarrel"]/researchPrerequisites</xpath>                                       
                    </li>                    

                    <li Class="PatchOperationRemove">
                      <xpath>Defs/ThingDef[defName="VFEM2_WineBarrel"]/researchPrerequisites</xpath>                                       
                    </li> --> 

                    <li Class="PatchOperationRemove">
                        <xpath>Defs/ThingDef[defName="BarrelProcessor"]/comps/li[@Class="ProcessorFramework.CompProperties_Processor"]/processes/li[.="VFEM2_Wine"]</xpath>
                    </li>

                    <li Class="PatchOperationRemove">
                        <xpath>Defs/ThingDef[defName="BarrelProcessor"]/comps/li[@Class="ProcessorFramework.CompProperties_Processor"]/processes/li[.="VFEM2_Mead"]</xpath>
                    </li>                  

                    <!-- put wine behind VFEM2_Wine -->
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="DankPyon_Plant_Grape"]/plant/sowResearchPrerequisites</xpath>
                        <value>
                            <sowResearchPrerequisites>
                                <li>VFEM2_Wine</li>
                            </sowResearchPrerequisites>
                        </value>
                    </li>

                    <li Class="PatchOperationReplace">
                        <xpath>Defs/RecipeDef[defName="DankPyon_MakeMustWine"]/researchPrerequisites</xpath>
                        <value>
                            <researchPrerequisites>
                                <li>VFEM2_Wine</li>
                            </researchPrerequisites>
                        </value>
                    </li>

                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="DankPyon_Wine"]/researchPrerequisites</xpath>
                        <value>
                            <researchPrerequisites>
                                <li>VFEM2_Wine</li>
                            </researchPrerequisites>
                        </value>
                    </li>

                    <!-- put VFEM2_Wine behind beer brewing -->
                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ResearchProjectDef[defName="VFEM2_Wine"]</xpath>
                        <value>
                            <prerequisites>
                                <li>Brewing</li>
                            </prerequisites>
                        </value>
                    </li>

                    <!-- grapes/must/wine-->   
                    <li Class="PatchOperationAdd">
                        <xpath>/Defs</xpath>
                        <value>
                            <ReplaceLib.ReplacerDef>
                                <defName>JOE_MO_VFEM2_GrapeStuff</defName>
                                <replacers>
                                    <li>
                                        <replace>VFEM2_Plant_Grape</replace>
                                        <with>DankPyon_Plant_Grape</with>
                                    </li>
                                    <li>
                                        <replace>VFEM2_Must</replace>
                                        <with>DankPyon_MustWine</with>
                                    </li>
                                    <li>
                                        <replace>VFEM2_Wine</replace>
                                        <with>DankPyon_Wine</with>
                                    </li>
                                    <li>
                                        <replace>VFEM2_RawGrapes</replace>
                                        <with>DankPyon_RawGrapes</with>
                                    </li>
                                    <li>
                                        <replace>VFEM2_MeadFermentingBarrel</replace>
                                        <with>BarrelProcessor</with>
                                    </li>
                                    <li>
                                        <replace>VFEM2_VFEM2_WineBarrel</replace>
                                        <with>BarrelProcessor</with>
                                    </li>
                                </replacers>
                            </ReplaceLib.ReplacerDef>
                        </value>
                    </li>   

                    <!-- add draught lab recipes to MO Alchemy Table -->
                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ThingDef[@Name="VFEM2_DraughtBase"]/recipeMaker/recipeUsers</xpath>
                      <value>
                        <recipeUsers>
                            <li>DankPyon_AlchemyBench</li>
                        </recipeUsers>
                      </value>
                    </li>

                    <li Class="PatchOperationReplace">
                      <xpath>Defs/RecipeDef[defName="VFEM2_MakeHerbalMedicine"]/recipeUsers</xpath>
                      <value>
                        <recipeUsers>
                            <li>DankPyon_AlchemyBench</li>
                        </recipeUsers>
                      </value>
                    </li>

                    <li Class="PatchOperationReplace">
                      <xpath>Defs/RecipeDef[defName="VFEM2_Make_ChemfuelFromWood"]/recipeUsers</xpath>
                      <value>
                        <recipeUsers>
                            <li>DankPyon_AlchemyBench</li>
                        </recipeUsers>
                      </value>
                    </li>

                    <li Class="PatchOperationReplace">
                      <xpath>Defs/RecipeDef[defName="VFEM2_Make_ChemfuelFromOrganics"]/recipeUsers</xpath>
                      <value>
                        <recipeUsers>
                            <li>DankPyon_AlchemyBench</li>
                        </recipeUsers>
                      </value>
                    </li>

                    <li Class="PatchOperationReplace">
                        <xpath>Defs/WorkGiverDef[defName="VFEM2_DoBillsAlchemyTable"]/fixedBillGiverDefs</xpath>
                        <value>
                            <fixedBillGiverDefs>
                                <li>DankPyon_AlchemyBench</li>
                            </fixedBillGiverDefs>
                        </value>
                    </li>

                    <li Class="PatchOperationReplace">
                        <xpath>Defs/WorkGiverDef[defName="VFEM2_DoBillsAlchemyTable_Electric"]/fixedBillGiverDefs</xpath>
                        <value>
                            <fixedBillGiverDefs>
                                <li>DankPyon_AlchemyBench</li>
                            </fixedBillGiverDefs>
                        </value>
                    </li>
                    
                    <!-- remove draught lab pre-reqs -->
                    <li Class="PatchOperationRemove">
                      <xpath>Defs/ThingDef[defName="VFEM2_AlchemicalWorkbench"]/researchPrerequisites</xpath>                      
                    </li>

                    <li Class="PatchOperationRemove">
                      <xpath>Defs/ThingDef[defName="VFEM2_AlchemicalWorkbench_Electric"]/researchPrerequisites</xpath>                                       
                    </li>

                    <!-- hide draught lab benches -->
                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ThingDef[defName="VFEM2_AlchemicalWorkbench"]/designationCategory</xpath>
                      <value>
                        <designationCategory></designationCategory>
                      </value>
                    </li>

                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ThingDef[defName="VFEM2_AlchemicalWorkbench_Electric"]/designationCategory</xpath>
                      <value>
                        <designationCategory></designationCategory>
                      </value>
                    </li>

                    <!-- draught research -->
                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ResearchProjectDef[defName="VFEM2_Alchemy"]/label</xpath>
                      <value>
                        <label>alchemical draughts</label>
                      </value>
                    </li>

                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ResearchProjectDef[defName="VFEM2_Alchemy"]/prerequisites</xpath>
                      <value>
                        <prerequisites>
                            <li>DankPyon_Alchemy</li>
                        </prerequisites>
                      </value>
                    </li>

                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ResearchProjectDef[defName="VFEM2_Alchemy"]/description</xpath>
                      <value>
                        <description>Learn to cultivate various alchemical reagents which can then be combined into various alchemical draughts.</description>		
                      </value>
                    </li>

                    <!-- hide VFEM2 castle wall -->
                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ThingDef[defName="VFEM2_CastleWall"]/designationCategory</xpath>
                      <value>
                        <designationCategory></designationCategory>
                      </value>
                    </li>

                    <li Class="PatchOperationRemove">
                      <xpath>Defs/ThingDef[defName="VFEM2_CastleWall"]/researchPrerequisites</xpath>
                    </li>
                    
                    <!-- castle wall -->
                    <li Class="PatchOperationAdd">
                        <xpath>/Defs</xpath>
                        <value>
                            <ReplaceLib.ReplacerDef>
                                <defName>JOE_MO_VFEM2_CastleWalls</defName>
                                <replacers>
                                    <li>
                                        <replace>VFEM2_CastleWall</replace>
                                        <with>DankPyon_CastleWall</with>
                                    </li>                                
                                </replacers>
                            </ReplaceLib.ReplacerDef>
                        </value>
                    </li>

                    <!-- castle wall research -->   
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[@Name="DankPyon_CastleWallBase"]/researchPrerequisites</xpath>
                        <value>
                            <researchPrerequisites>
                                <li>VFEM2_MedievalArchitecture</li>
                            </researchPrerequisites>
                        </value>
                    </li>

                    <!-- hearth -->
                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ThingDef[defName="VFEM2_Hearth"]/label</xpath>
                      <value>
                        <label>large hearth</label>
                      </value>
                    </li>

                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ThingDef[defName="VFEM2_HearthDarklight"]/label</xpath>
                      <value>
                        <label>large darklight hearth</label>
                      </value>
                    </li>

                    <!-- hide VFEM2 fur beds and remove research pre reqs -->
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="VFEM2_FurBed"]/researchPrerequisites</xpath>
                        <value>
                            <researchPrerequisites></researchPrerequisites>
                        </value>
                    </li>

                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="VFEM2_FurBed"]</xpath>
                        <value>
                            <designationCategory></designationCategory>
                        </value>
                    </li>

                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="VFEM2_DoubleFurBed"]/researchPrerequisites</xpath>
                        <value>
                            <researchPrerequisites></researchPrerequisites>
                        </value>
                    </li>

                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="VFEM2_DoubleFurBed"]</xpath>
                        <value>
                            <designationCategory></designationCategory>
                        </value>
                    </li>

                   <!-- fur beds -->
                    <li Class="PatchOperationAdd">
                        <xpath>/Defs</xpath>
                        <value>
                            <ReplaceLib.ReplacerDef>
                                <defName>JOE_MO_VFEM2_FurBeds</defName>
                                <replacers>
                                    <li>
                                        <replace>VFEM2_FurBed</replace>
                                        <with>DankPyon_BedFur</with>
                                    </li>       
                                    <li>
                                        <replace>VFEM2_DoubleFurBed</replace>
                                        <with>DankPyon_BedFurDouble</with>
                                    </li>                                
                                </replacers>
                            </ReplaceLib.ReplacerDef>
                        </value>
                    </li>

                     <!-- remove smithing anvil pre-reqs and hide -->

                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="VFEM2_SmithingAnvil"]</xpath>
                        <value>
                            <researchPrerequisites></researchPrerequisites>
                        </value>
                    </li>

                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="VFEM2_SmithingAnvil"]</xpath>
                        <value>
                            <designationCategory></designationCategory>
                        </value>
                    </li>

                    <!-- hide MO bellows-->
                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ThingDef[defName="DankPyon_Bellows"]/designationCategory</xpath>
                      <value>
                        <designationCategory></designationCategory>
                      </value>
                    </li>

                    <li Class="PatchOperationRemove">
                      <xpath>Defs/ThingDef[defName="DankPyon_Bellows"]/researchPrerequisites</xpath>
                    </li>

                    <!-- forge bellows -->
                    <li Class="PatchOperationAdd">
                        <xpath>/Defs</xpath>
                        <value>
                            <ReplaceLib.ReplacerDef>
                                <defName>JOE_MO_VFEM2_Bellows</defName>
                                <replacers>
                                    <li>
                                        <replace>DankPyon_Bellows</replace>
                                        <with>VFEM2_ForgeBellows</with>
                                    </li>                                
                                </replacers>
                            </ReplaceLib.ReplacerDef>
                        </value>
                    </li>

                    <!-- hide MO palisade walls -->
                    <li Class="PatchOperationReplace">
                      <xpath>Defs/ThingDef[defName="DankPyon_Palisade"]/designationCategory</xpath>
                      <value>
                        <designationCategory></designationCategory>
                      </value>
                    </li>

                    <!-- palisade walls -->
                    <li Class="PatchOperationAdd">
                        <xpath>/Defs</xpath>
                        <value>
                            <ReplaceLib.ReplacerDef>
                                <defName>JOE_MO_VFEM2_PalisadeWalls</defName>
                                <replacers>
                                    <li>
                                        <replace>DankPyon_Palisade</replace>
                                        <with>VFEM2_Palisade</with>
                                    </li>
                                </replacers>
                            </ReplaceLib.ReplacerDef>
                        </value>
                    </li>
                    
                    <li Class="PatchOperationReplace">
                    <xpath>Defs/ThingDef[defName="VFEM2_Palisade"]/stuffCategories</xpath>
                    <value>
                        <stuffCategories>
                        			<li>DankPyon_RawWood</li>
                        </stuffCategories>
                    </value>
                  </li>
                  
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="VFEM2_Palisade"]/costStuffCount</xpath>
                        <value>
                            <costStuffCount>8</costStuffCount>
                        </value>
                    </li> 

                </operations>
	</Operation>
</Patch>	
